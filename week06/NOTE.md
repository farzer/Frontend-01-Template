## 状有限态机

- 每个状态都是一个机器
  - 所有的机器接受的输入是一致的
  - 状态机的每个机器本身没有状态，对应纯函数
- 每个机器知道下一个状态
  - 每个机器都有确定的下一个状态（moore状态机）
  - 每个机器根据输入决定下一个状态（mealy状态机）

### mealy 状态机

每个函数是一个状态

```js
function state(c) {
  // 自动编码实现逻辑
  return next;
}

// 调用
while(input) {
  state = state(input)
}
```

## HTML 解析

### 第一步

- 为了方便文件管理，把 parser 单独拆到一个文件中
- parser 接受 HTML 文本作为参数，返回一颗 DOM 树

### 第二步

- 用FSM来实现HTML的分析
- 在HTML标准中，已经规定了HTML的状态
- 只挑选其中一部分状态，完成一个最简单的版本

### 第三步

- 主要的标签有：开始标签，结束标签和自闭合标签
- 暂时忽略属性

### 第四步

- 在状态机中，除了状态迁移，加入业务逻辑
- 在标签结束状态提交 token

### 第五步

- 属性值分为单引号、双引号、无引号三种写法，因此需要较多的状态处理
- 处理属性方式跟标签类似
- 属性结束的时候，把属性加到标签的 token 上